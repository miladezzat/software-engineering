---
card: "https://cdn-media-1.freecodecamp.org/images/1*3L4lzv7L5K6VcauwadO_7w.jpeg"
tags: [Ssl]
description: "by Alexey Samoshkin"
author: "Milad E. Fahmy"
title: "OpenSSL command cheatsheet"
created: "2021-08-16T11:47:45+02:00"
modified: "2021-08-16T11:47:45+02:00"
---
<div class="site-wrapper">
<main id="site-main" class="site-main outer">
<div class="inner">
<article class="post-full post tag-ssl tag-security tag-technology tag-tech tag-development ">
<header class="post-full-header">
<h1 class="post-full-title">OpenSSL command cheatsheet</h1>
</header>
<figure class="post-full-image">
<picture>
<source media="(max-width: 700px)" sizes="1px" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 1w">
<source media="(min-width: 701px)" sizes="(max-width: 800px) 400px,
(max-width: 1170px) 700px,
1400px" srcset="https://cdn-media-1.freecodecamp.org/images/1*3L4lzv7L5K6VcauwadO_7w.jpeg 300w,
https://cdn-media-1.freecodecamp.org/images/1*3L4lzv7L5K6VcauwadO_7w.jpeg 600w,
https://cdn-media-1.freecodecamp.org/images/1*3L4lzv7L5K6VcauwadO_7w.jpeg 1000w,
https://cdn-media-1.freecodecamp.org/images/1*3L4lzv7L5K6VcauwadO_7w.jpeg 2000w">
<img onerror="this.style.display='none'" src="https://cdn-media-1.freecodecamp.org/images/1*3L4lzv7L5K6VcauwadO_7w.jpeg" alt="OpenSSL command cheatsheet">
</picture>
</figure>
<section class="post-full-content">
<div class="post-content medium-migrated-article">
<p>by Alexey Samoshkin</p><p>When it comes to security-related tasks, like generating keys, CSRs, certificates, calculating digests, debugging TLS connections and other tasks related to PKI and HTTPS, you’d most likely end up using the OpenSSL tool.</p><p>OpenSSL includes tonnes of features covering a broad range of use cases, and it’s difficult to remember its syntax for all of them and quite easy to get lost. <code>man</code> pages are not so helpful here, so often we just Google “openssl how to [use case here]” or look for some kind of “openssl cheatsheet” to recall the usage of a command and see examples.</p><p>This post is my personal collection of <code>openssl</code> command snippets and examples, grouped by use case.</p><h3 id="use-cases">Use cases</h3><p>Here is a list of use cases, that I’ll be covering:</p><ol><li><a href="#0507" rel="noopener">Working with RSA and ECDSA keys</a></li><li><a href="#bdf8" rel="noopener">Create certificate signing requests (CSR)</a></li><li><a href="#b723" rel="noopener">Create X.509 certificates</a></li><li><a href="#2322" rel="noopener">Verify CSRs or certificates</a></li><li><a href="#4fe9" rel="noopener">Calculate message digests and base64 encoding</a></li><li><a href="#4d47" rel="noopener">TLS client to connect to a remote server</a></li><li><a href="#0f65" rel="noopener">Measure TLS connection and handshake time</a></li><li><a href="#ce64" rel="noopener">Convert between encoding (PEM, DER) and container formats (PKCS12, PKCS7)</a></li><li><a href="#dcab" rel="noopener">List ciphers suites</a></li><li><a href="#e48c" rel="noopener">Manually check certificate revocation status from OCSP responder</a></li></ol><p>Surely, this is not a complete list, but it covers the most common use cases and includes those I’ve been working with. For example, I skip encryption and decryption, or using openssl for CA management. <code>openssl</code> is like a universe. You never know where it ends. ?</p><h3 id="working-with-rsa-and-ecdsa-keys">Working with RSA and ECDSA keys</h3><p>In the commands below, replace <code>[bits]</code> with the key size (For example, 2048, 4096, 8192).</p><p>Generate an RSA key:<br><code>openssl genrsa -out example.key [bits]</code></p><p>Print public key or modulus only:<br><code>openssl rsa -in example.key -pubout</code><br><code>openssl rsa -in example.key -noout -modulus</code></p><p>Print textual representation of RSA key:<br><code>openssl rsa -in example.key -text -noout</code></p><p>Generate new RSA key and encrypt with a pass phrase based on AES CBC 256 encryption:<br><code>openssl genrsa -aes256 -out example.key [bits]</code></p><p>Check your private key. If the key has a pass phrase, you’ll be prompted for it:<br><code>openssl rsa -check -in example.key</code></p><p>Remove passphrase from the key:<br><code>openssl rsa -in example.key -out example.key</code></p><p>Encrypt existing private key with a pass phrase:<br><code>openssl rsa -des3 -in example.key -out example_with_pass.key</code></p><p>Generate ECDSA key. <code>curve</code> is to be replaced with: <code>prime256v1</code>, <code>secp384r1</code>, <code>secp521r1</code>, or any other supported elliptic curve:<br><code>openssl ecparam -genkey -name [curve] | openssl ec -out example.ec.key</code></p><p>Print ECDSA key textual representation:<br><code>openssl ec -in example.ec.key -text -noout</code></p><p>List available EC curves, that OpenSSL library supports:<br><code>openssl ecparam -list_curves</code></p><p>Generate DH params with a given length:<br><code>openssl dhparam -out dhparams.pem [bits]</code></p><h3 id="create-certificate-signing-requests-csr-">Create certificate signing requests (CSR)</h3><p>In the commands below, replace <code>[digest]</code> with the name of the supported hash function: <code>md5</code>, <code>sha1</code>, <code>sha224</code>, <code>sha256</code>, <code>sha384</code> or <code>sha512</code>, etc. It’s better to avoid weak functions like <code>md5</code> and <code>sha1</code>, and stick to <code>sha256</code> and above.</p><p>Create a CSR from existing private key.<br><code>openssl req -new -key example.key -out example.csr -[digest]</code></p><p>Create a CSR and a private key without a pass phrase in a single command:<br><code>openssl req -nodes -newkey rsa:[bits] -keyout example.key -out example.csr</code></p><p>Provide CSR subject info on a command line, rather than through interactive prompt.<br><code>openssl req -nodes -newkey rsa:[bits] -keyout example.key -out example.csr -subj "/C=UA/ST=Kharkov/L=Kharkov/O=Super Secure Company/OU=IT Department/CN=example.com"</code></p><p>Create a CSR from existing certificate and private key:<br><code>openssl x509 -x509toreq -in cert.pem -out example.csr -signkey example.key</code></p><p>Generate a CSR for multi-domain SAN certificate by supplying an openssl config file:<br><code>openssl req -new -key example.key -out example.csr -config req.conf</code></p><p>where <code>req.conf</code>:</p><pre><code>[req]prompt=nodefault_md = sha256distinguished_name = dnreq_extensions = req_ext</code></pre><pre><code>[dn]CN=example.com</code></pre><pre><code>[req_ext]subjectAltName=@alt_names</code></pre><pre><code>[alt_names]DNS.1=example.comDNS.2=www.example.comDNS.3=ftp.example.com</code></pre><h3 id="create-x-509-certificates">Create X.509 certificates</h3><p>Create self-signed certificate and new private key from scratch:<br><code>openssl req -nodes -newkey rsa:2048 -keyout example.key -out example.crt -x509 -days 365</code></p><p>Create a self signed certificate using existing CSR and private key:<br><code>openssl x509 -req -in example.csr -signkey example.key -out example.crt -days 365</code></p><p>Sign child certificate using your own “CA” certificate and it’s private key. If you were a CA company, this shows a very naive example of how you could issue new certificates.<br><code>openssl x509 -req -in child.csr -days 365 -CA ca.crt -CAkey ca.key -set_serial 01 -out child.crt</code></p><p>Print textual representation of the certificate<br><code>openssl x509 -in example.crt -text -noout</code></p><p>Print certificate’s fingerprint as md5, sha1, sha256 digest:<br><code>openssl x509 -in cert.pem -fingerprint -sha256 -noout</code></p><h3 id="verify-csrs-or-certificates">Verify CSRs or certificates</h3><p>Verify a CSR signature:<br><code>openssl req -in example.csr -verify</code></p><p>Verify that private key matches a certificate and CSR:<br><code>openssl rsa -noout -modulus -in example.key | openssl sha256</code><br><code>openssl x509 -noout -modulus -in example.crt | openssl sha256</code><br><code>openssl req -noout -modulus -in example.csr | openssl sha256</code></p><p>Verify certificate, provided that you have root and any intemediate certificates configured as trusted on your machine:<br><code>openssl verify example.crt</code></p><p>Verify certificate, when you have intermediate certificate chain. Root certificate is not a part of bundle, and should be configured as a trusted on your machine.<br><code>openssl verify -untrusted intermediate-ca-chain.pem example.crt</code></p><p>Verify certificate, when you have intermediate certificate chain and root certificate, that is not configured as a trusted one.<br><code>openssl verify -CAFile root.crt -untrusted intermediate-ca-chain.pem child.crt</code></p><p>Verify that certificate served by a remote server covers given host name. Useful to check your mutlidomain certificate properly covers all the host names.<br><code>openssl s_client -verify_hostname <a href="http://www.example.com" rel="noopener">www.example.com</a> -connect example.com:443</code></p><h3 id="calculate-message-digests-and-base64-encoding">Calculate message digests and base64 encoding</h3><p>Calculate <code>md5</code>, <code>sha1</code>, <code>sha256</code>, <code>sha384</code>, <code>sha512</code>digests:<br><code>openssl dgst -[hash_function] &lt;input.f</code>i<code>le</code><br><code>cat input.file | openssl [hash_functi</code>on]</p><p>Base64 encoding and decoding:<br><code>cat /dev/urandom | head -c 50 | openssl base64 | openssl base64 -d</code></p><h3 id="tls-client-to-connect-to-a-remote-server">TLS client to connect to a remote server</h3><p>Connect to a server supporting TLS:<br><code>openssl s_client -connect <a href="http://www.google.com:443" rel="noopener">example.com:443</a></code><br><code>openssl s_client -host example.com -port 443</code></p><p>Connect to a server and show full certificate chain:<br><code>openssl s_client -showcerts -host example.com -port 443 &lt;/dev/n</code>ull</p><p>Extract the certificate:<br><code>openssl s_client -connect example.com:443 2&gt;&amp;1 &lt; /dev/null | sed -n '/-----BEGIN/,/-----END/p' &gt; certif</code>icate.pem</p><p>Override SNI (Server Name Indication) extension with another server name. Useful for testing when multiple secure sites are hosted on same IP address:<br><code>openssl s_client -servername <a href="http://www.foobbz.site" rel="noopener">www.</a>example.com -host example.com -port 443</code></p><p>Test TLS connection by forcibly using specific cipher suite, e.g. <code>ECDHE-RSA-AES128-GCM-SHA256</code>. Useful to check if a server can properly talk via different configured cipher suites, not one it prefers.<br><code>openssl s_client -host example.com -port 443 -cipher ECDHE-RSA-AES128-GCM-SHA256 2&gt;&amp;1 &lt;/de</code>v/null</p><h3 id="measure-tls-connection-and-handshake-time">Measure TLS connection and handshake time</h3><p>Measure SSL connection time without/with session reuse:<br><code>openssl s_time -connect example.com:443 -new</code><br><code>openssl s_time -connect example.com:443 -reuse</code></p><p>Roughly examine TCP and SSL handshake times using <code>curl</code>:<br><code>curl -kso /dev/null -w "tcp:%{time_connect}, ssldone:%{time_appconnect}\n" https://example.com</code></p><p>Measure speed of various security algorithms:<br><code>openssl speed rsa2048</code><br><code>openssl speed ecdsap256</code></p><h3 id="convert-between-encoding-and-container-formats">Convert between encoding and container formats</h3><p>Convert certificate between DER and PEM formats:<br><code>openssl x509 -in example.pem -outform der -out example.der</code><br><code>openssl x509 -in example.der -inform der -out example.pem</code></p><p>Combine several certificates in PKCS7 (P7B) file:<br><code>openssl crl2pkcs7 -nocrl -certfile child.crt -certfile ca.crt -out example.p7b</code></p><p>Convert from PKCS7 back to PEM. If PKCS7 file has multiple certificates, the PEM file will contain all of the items in it.<br><code>openssl pkcs7 -in example.p7b -print_certs -out example.crt</code></p><p>Combine a PEM certificate file and a private key to PKCS#12 (.pfx .p12). Also, you can add a chain of certificates to PKCS12 file.<br><code>openssl pkcs12 -export -out certificate.pfx -inkey privkey.pem -in certificate.pem -certfile ca-chain.pem</code></p><p>Convert a PKCS#12 file (.pfx .p12) containing a private key and certificates back to PEM:<br><code>openssl pkcs12 -in keystore.pfx -out keystore.pem -nodes</code></p><h3 id="list-cipher-suites">List cipher suites</h3><p>List available TLS cipher suites, openssl client is capable of:<br><code>openssl ciphers -v</code></p><p>Enumerate all individual cipher suites, which are described by a short-hand OpenSSL cipher list string. This is useful when you’re configuring server (like Nginx), and you need to test your <code>ssl_ciphers</code> string.<br><code>openssl ciphers -v 'EECDH+ECDSA+AESGCM:EECDH+aRSA+SHA256:EECDH:DHE+AESGCM:DHE:!RSA!aNULL:!eNULL:!LOW:!RC4'</code></p><h3 id="manually-check-certificate-revocation-status-from-ocsp-responder">Manually check certificate revocation status from OCSP responder</h3><p>This is a multi-step process:</p><ol><li>Retrieve the certificate from a remote server</li><li>Obtain the intermediate CA certificate chain</li><li>Read OCSP endpoint URI from the certificate</li><li>Request a remote OCSP responder for certificate revocation status</li></ol><p>First, retrieve the certificate from a remote server:<br><code>openssl s_client -connect example.com:443 2&gt;&amp;1 &lt; /dev/null | sed -n '/-----BEGIN/,/-----END/p' &gt;</code> cert.pem</p><p>You’d also need to obtain intermediate CA certificate chain. Use <code>-showcerts </code>flag to show full certificate chain, and manually save all intermediate certificates to <code>chain.pem</code> file:<br><code>openssl s_client -showcerts -host example.com -port 443 &lt;/dev/n</code>ull</p><p>Read OCSP endpoint URI from the certificate:<br><code>openssl x509 -in cert.pem -noout -ocsp_uri</code></p><p>Request a remote OCSP responder for certificate revocation status using the URI from the above step (e.g. http://ocsp.stg-int-x1.letsencrypt.org). <br><code>openssl ocsp -header "Host" "ocsp.stg-int-x1.letsencrypt.org" -issuer chain.pem -VAfile chain.pem -cert cert.pem -text -url <a href="http://ocsp.stg-int-x1.letsencrypt.org" rel="noopener">http://ocsp.stg-int-x1.letsencrypt.org</a></code></p><h3 id="resources">Resources</h3><p>I’ve put together a few resources about OpenSSL that you may find useful.</p><p>OpenSSL Essentials: Working with SSL Certificates, Private Keys and CSRs | DigitalOcean — <a href="https://www.digitalocean.com/community/tutorials/openssl-essentials-working-with-ssl-certificates-private-keys-and-csrs" rel="noopener">https://www.digitalocean.com/community/tutorials/openssl-essentials-working-with-ssl-certificates-private-keys-and-csrs</a></p><p>The Most Common OpenSSL Commands — <a href="https://www.sslshopper.com/article-most-common-openssl-commands.html" rel="noopener">https://www.sslshopper.com/article-most-common-openssl-commands.html</a></p><p>OpenSSL: Working with SSL Certificates, Private Keys and CSRs — <a href="https://www.dynacont.net/documentation/linux/openssl/" rel="noopener">https://www.dynacont.net/documentation/linux/openssl/</a></p>
</div>
<hr>
</section>
</article>
</div>
</main>
</div>
<!-- Google Tag Manager (noscript) -->
<!-- End Google Tag Manager (noscript) -->
