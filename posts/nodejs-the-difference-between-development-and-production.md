---
card: "/images/default.jpg"
tags: [Node]
author: "Milad E. Fahmy"
title: "Node.js, the difference between development and production"
created: "2021-08-20T13:40:58+02:00"
modified: "2021-08-20T13:40:58+02:00"
---
<div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="layout-container"><main class="grid-container"><article class="article-reader"><h1 class="article-reader__headline">Node.js, the difference between development and production</h1><div><p>You can have different configurations for production and development environments.</p><p>Node.js assumes it's always running in a development environment.
You can signal Node.js that you are running in production by setting the <code class="language-text">NODE_ENV=production</code> environment variable.</p><p>This is usually done by executing the command</p><pre class="prism-code language-bash"><div class="shell-box-top"><span>BASH</span><button type="button">copy</button></div><div class="token-line"><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable">NODE_ENV</span><span class="token operator">=</span><span class="token plain">production</span></div><div class="token-line"><span class="token plain">
</span></div></pre><p>in the shell, but it's better to put it in your shell configuration file (e.g. <code class="language-text">.bash_profile</code> with the Bash shell) because otherwise the setting does not persist in case of a system restart.</p><p>You can also apply the environment variable by prepending it to your application initialization command:</p><pre class="prism-code language-bash"><div class="shell-box-top"><span>BASH</span><button type="button">copy</button></div><div class="token-line"><span class="token assign-left variable">NODE_ENV</span><span class="token operator">=</span><span class="token plain">production node app.js</span></div><div class="token-line"><span class="token plain">
</span></div></pre><p>This environment variable is a convention that is widely used in external libraries as well.</p><p>Setting the environment to <code class="language-text">production</code> generally ensures that</p><ul><li>logging is kept to a minimum, essential level</li><li>more caching levels take place to optimize performance</li></ul><p>For example Pug, the templating library used by Express, compiles in debug mode if <code class="language-text">NODE_ENV</code> is not set to <code class="language-text">production</code>. Express views are compiled in every request in development mode, while in production they are cached. There are many more examples.</p><p>You can use conditional statements to execute code in different environments:</p><pre class="prism-code language-js"><div class="shell-box-top"><span>JS</span><button type="button">copy</button></div><div class="token-line"><span class="token keyword control-flow">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">process</span><span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">NODE_ENV</span><span class="token plain"> </span><span class="token operator">===</span><span class="token plain"> </span><span class="token string">"development"</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">//...</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword control-flow">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">process</span><span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">NODE_ENV</span><span class="token plain"> </span><span class="token operator">===</span><span class="token plain"> </span><span class="token string">"production"</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">//...</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword control-flow">if</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'production'</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">'staging'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">indexOf</span><span class="token punctuation">(</span><span class="token plain">process</span><span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">NODE_ENV</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">&gt;=</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">//...</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div></pre><p>For example, in an Express app, you can use this to set different error handlers per environment:</p><pre class="prism-code language-js"><div class="shell-box-top"><span>JS</span><button type="button">copy</button></div><div class="token-line"><span class="token keyword control-flow">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">process</span><span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">NODE_ENV</span><span class="token plain"> </span><span class="token operator">===</span><span class="token plain"> </span><span class="token string">"development"</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  app</span><span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token plain">express</span><span class="token punctuation">.</span><span class="token method function property-access">errorHandler</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"> dumpExceptions</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token plain"> showStack</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword control-flow">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">process</span><span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">NODE_ENV</span><span class="token plain"> </span><span class="token operator">===</span><span class="token plain"> </span><span class="token string">"production"</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  app</span><span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token plain">express</span><span class="token punctuation">.</span><span class="token method function property-access">errorHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div></pre></div></article></main></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div>
